<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:indres="http://itsnat.org/itsnatdroid/resource"

    indres:valueAnimatorTest="@remote:animator/droid/res/animator/test_value_animator_remote.xml"
    indres:animatorSetTest="@remote:animator/droid/res/animator/test_animator_set_remote.xml"
    indres:sportArrayByServlet="@remote:array/ItsNatDroidServletExample?itsnat_doc_name=test_droid_sports_array:sports_array"
    indres:sportArrayByStaticFile="@remote:array/droid/res/values/arrays_remote.xml:sports_array"
    indres:animAlphaTest="@remote:anim/droid/res/anim/test_animation_alpha_remote.xml"
    indres:animRotateTest="@remote:anim/droid/res/anim/test_animation_rotate_remote.xml"
    indres:animScaleTest="@remote:anim/droid/res/anim/test_animation_scale_remote.xml"
    indres:animTranslateTest1="@remote:anim/droid/res/anim/test_animation_translate_1_remote.xml"
    indres:animTranslateTest2="@remote:anim/droid/res/anim/test_animation_translate_2_remote.xml"
    indres:animSetTest="@remote:anim/droid/res/anim/test_animation_set_remote.xml"
    indres:layoutTest="@remote:layout/droid/res/layout/auto_complete_text_view_hint_view_remote.xml"
    


    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fillViewport="true" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:padding="10dp"
        android:orientation="vertical">

        <Button
            android:id="@id/back"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="BACK" />

        <Button
            android:id="@id/buttonReload"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/button_reload" />

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ObjectAnimator Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>


        <AdapterViewFlipper
            id="objectAnimatorTestId1"
            android:layout_width="match_parent"
            android:layout_height="60dp"
            android:animateFirstView="true"
            android:inAnimation="@animator/object_animator_test"
            android:loopViews="true"
            android:outAnimation="@animator/object_animator_test"
            android:autoStart="true"
            android:flipInterval="2000"  />

        <AdapterViewFlipper
            id="objectAnimatorTestId2"
            android:layout_width="match_parent"
            android:layout_height="60dp"
            android:animateFirstView="true"
            android:inAnimation="@remote:animator/droid/res/animator/test_object_animator_remote.xml"
            android:loopViews="true"
            android:outAnimation="@remote:animator/droid/res/animator/test_object_animator_remote.xml"
            android:autoStart="true"
            android:flipInterval="2000"  />

        <AdapterViewFlipper
            id="objectAnimatorTestId3"
            android:layout_width="match_parent"
            android:layout_height="60dp"
            android:animateFirstView="true"
            android:inAnimation="@remote:animator/droid/res/values/test_values_remote.xml:test_animator_object_animator_values"
            android:loopViews="true"
            android:outAnimation="@remote:animator/droid/res/values/test_values_remote.xml:test_animator_object_animator_values"
            android:autoStart="true"
            android:flipInterval="2000"  />

        <AdapterViewFlipper
            id="objectAnimatorTestId4"
            android:layout_width="match_parent"
            android:layout_height="60dp"
            android:background="@android:color/white"
            android:animateFirstView="true"
            android:inAnimation="@remote:animator/droid/res/animator/test_object_animator_2_remote.xml"
            android:loopViews="true"
            android:autoStart="true"
            android:flipInterval="2000"  />

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ValueAnimator Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            id="valueAnimatorTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ValueAnimator Test 1"
            android:textSize="15dp"
            android:background="@android:color/white"/>

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="AnimatorSet Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            id="animatorSetTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="AnimatorSet Test 1"
            android:textSize="15dp"
            android:background="@android:color/holo_green_light" />

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="10dp"
            android:text="Animation Tests"
            android:textSize="20dp"
            android:background="#00ff00"/>

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="AlphaAnimation Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            android:id="@+id/alphaAnimationTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="AlphaAnimation Test 1"
            android:textSize="15dp"
            android:background="#cccccc"/>

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="RotateAnimation Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            android:id="@+id/rotateAnimationTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="RotateAnimation Test 1"
            android:textSize="15dp"
            android:background="#cccccc"/>

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ScaleAnimation Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            android:id="@+id/scaleAnimationTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ScaleAnimation Test 1"
            android:textSize="15dp"
            android:background="#cccccc"/>

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="TranslateAnimation Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            android:id="@+id/translateAnimationTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="TranslateAnimation Test 1"
            android:textSize="15dp"
            android:background="#cccccc"/>

        <TextView
            android:id="@+id/translateAnimationTestId2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="TranslateAnimation Test 2"
            android:textSize="15dp"
            android:background="#cccccc"/>

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="AnimationSet Tests"
            android:textSize="15dp"
            android:background="#00ff00"/>

        <TextView
            android:id="@+id/animationSetTestId1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="AnimationSet Test 1"
            android:textSize="15dp"
            android:background="#cccccc"/>

    </LinearLayout>

    <script><![CDATA[
        import org.itsnat.itsnatdroidtest.R;
        import org.itsnat.itsnatdroidtest.testact.TestActivity;
        import org.itsnat.itsnatdroidtest.testact.util.*;
        import android.animation.*;
        import android.view.animation.*;

        
        void initialConfiguration(TestActivity act, View rootView)
        {
            defineObjectAnimatorTests(act,rootView);
            defineValueAnimatorTests(act,rootView);
            defineSetAnimatorTests(act,rootView);

            defineAlphaAnimationTests(act,rootView);
            defineRotateAnimationTests(act,rootView);
            defineScaleAnimationTests(act,rootView);
            defineTranslateAnimationTests(act,rootView);
            defineAnimationSetTests(act,rootView);
            itsNatResourcesOtherTests(act,rootView);
        }

        void defineObjectAnimatorTests(TestActivity act, View rootView)
        {
            AdapterViewFlipper viewFlipper;
            ArrayAdapter adapter;

            viewFlipper = (AdapterViewFlipper) itsNatDoc.findViewByXMLId("objectAnimatorTestId1");
            adapter = ArrayAdapter.createFromResource(act, R.array.sports_array, android.R.layout.simple_list_item_1);
            viewFlipper.setAdapter(adapter);

            viewFlipper = (AdapterViewFlipper) itsNatDoc.findViewByXMLId("objectAnimatorTestId2");
            adapter = ArrayAdapter.createFromResource(act, R.array.sports_array, android.R.layout.simple_list_item_1);
            viewFlipper.setAdapter(adapter);

            CharSequence[] sportsArray;

            viewFlipper = (AdapterViewFlipper) itsNatDoc.findViewByXMLId("objectAnimatorTestId3");
            sportsArray = itsNatDoc.getItsNatResources().getTextArray("@remote:array/ItsNatDroidServletExample?itsnat_doc_name=test_droid_sports_array:sports_array");
            adapter = new ArrayAdapter(act,android.R.layout.simple_list_item_1,sportsArray); // Beanshell does not support generics
            viewFlipper.setAdapter(adapter);

            viewFlipper = (AdapterViewFlipper) itsNatDoc.findViewByXMLId("objectAnimatorTestId4");
            sportsArray = itsNatDoc.getItsNatResources().getTextArray("@remote:array/droid/res/values/arrays_remote.xml:sports_array");
            adapter = new ArrayAdapter(act,android.R.layout.simple_list_item_1,sportsArray); // Beanshell does not support generics
            viewFlipper.setAdapter(adapter);
        }


        void defineValueAnimatorTests(TestActivity act, View rootView)
        {
            TextView textView = (TextView) itsNatDoc.findViewByXMLId("valueAnimatorTestId1");

            ValueAnimator valueAnimator = (ValueAnimator)itsNatDoc.getItsNatResources().getAnimator("@remote:animator/droid/res/animator/test_value_animator_remote.xml");

            valueAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {
                public void onAnimationUpdate(ValueAnimator animation) {
                    Integer value = (Integer) animation.getAnimatedValue();
                    textView.setBackgroundColor(value);
                }
            });

            valueAnimator.start();

            if (valueAnimator.getDuration() != 2000) alert("TEST FAILED duration: " + valueAnimator.getDuration());
            if (valueAnimator.getRepeatCount() != -1) alert("TEST FAILED repeatCount: " + valueAnimator.getRepeatCount());
            if (valueAnimator.getRepeatMode() != 2) alert("TEST FAILED repeatCount: " + valueAnimator.getRepeatMode());
            if (valueAnimator.getStartDelay() != 10) alert("TEST FAILED repeatCount: " + valueAnimator.getStartDelay());
        }

        void defineSetAnimatorTests(TestActivity act, View rootView)
        {
            final TextView textView = (TextView) itsNatDoc.findViewByXMLId("animatorSetTestId1");

            AnimatorSet animatorSet = (AnimatorSet)itsNatDoc.getItsNatResources().getAnimator("@remote:animator/droid/res/animator/test_animator_set_remote.xml");

            animatorSet.setTarget(textView);

            animatorSet.addListener(new Animator.AnimatorListener()
            {
                public void onAnimationStart(Animator animation)  { }

                public void onAnimationEnd(Animator animation)
                {
                    animatorSet.start();
                }

                public void onAnimationCancel(Animator animation) { }

                 public void onAnimationRepeat(Animator animation) { }
            });

            animatorSet.start();

            // No testing of AnimatorSet here, many tests are executed as assets
        }

        void defineAlphaAnimationTests(TestActivity act, View rootView)
        {
            TextView textView = (TextView) rootView.findViewById(R.id.alphaAnimationTestId1);
            AlphaAnimation alphaAnimation = (AlphaAnimation) itsNatDoc.getItsNatResources().getAnimation("@remote:anim/droid/res/anim/test_animation_alpha_remote.xml");
            textView.startAnimation(alphaAnimation);
        }

        void defineRotateAnimationTests(TestActivity act, View rootView)
        {
            TextView textView = (TextView) rootView.findViewById(R.id.rotateAnimationTestId1);
            RotateAnimation rotateAnimation = (RotateAnimation) itsNatDoc.getItsNatResources().getAnimation("@remote:anim/droid/res/anim/test_animation_rotate_remote.xml");
            textView.startAnimation(rotateAnimation);
        }

        void defineScaleAnimationTests(TestActivity act, View rootView)
        {
            TextView textView = (TextView) rootView.findViewById(R.id.scaleAnimationTestId1);
            ScaleAnimation animation = (ScaleAnimation) itsNatDoc.getItsNatResources().getAnimation("@remote:anim/droid/res/anim/test_animation_scale_remote.xml");
            textView.startAnimation(animation);
        }

        void defineTranslateAnimationTests(TestActivity act, View rootView)
        {
            {
                TextView textView = (TextView) rootView.findViewById(R.id.translateAnimationTestId1);
                TranslateAnimation animation = (TranslateAnimation) itsNatDoc.getItsNatResources().getAnimation("@remote:anim/droid/res/anim/test_animation_translate_1_remote.xml");
                textView.startAnimation(animation);
            }

            {
                TextView textView = (TextView) rootView.findViewById(R.id.translateAnimationTestId2);
                TranslateAnimation animation = (TranslateAnimation) itsNatDoc.getItsNatResources().getAnimation("@remote:anim/droid/res/anim/test_animation_translate_2_remote.xml");
                textView.startAnimation(animation);
            }
        }        
        
        void defineAnimationSetTests(TestActivity act, View rootView)
        {
            TextView textView = (TextView) rootView.findViewById(R.id.animationSetTestId1);
            AnimationSet animation = (AnimationSet) itsNatDoc.getItsNatResources().getAnimation("@remote:anim/droid/res/anim/test_animation_set_remote.xml");
            textView.startAnimation(animation);
        }        
        
        void itsNatResourcesOtherTests(TestActivity act, View rootView)
        {     
            // Test ItsNatResources.getLayout()                  
            TextView textView = itsNatDoc.getItsNatResources().getLayout("@remote:layout/droid/res/layout/auto_complete_text_view_hint_view_remote.xml", null, -1);              
            Assert.assertNotNull(textView);           
            Assert.assertNotNull(textView.getId());        
        }       
        
                
        TestActivity act = (TestActivity)itsNatDoc.getPage().getContext();
        View rootView = itsNatDoc.getRootView();

        initialConfiguration(act,rootView);
    ]]></script>

</ScrollView>
